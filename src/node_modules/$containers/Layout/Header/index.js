import React, { Component } from 'react';

import NavPanel from '$containers/Layout/NavPanel'
import { Link } from 'react-router-dom';

import { connect } from 'react-redux';
import style from './Header.module.css';
import { getScrollBarSize, getDocHeight } from '$helpers/ui';

class Header extends Component {

  renderModals = (modal) => {
    if (!modal.modals.length) {
      document.body.style.overflow = '';
      document.body.style.paddingRight = '';
      return null;
    }
    document.body.style.overflow = 'hidden';
    if (getDocHeight() > document.documentElement.clientHeight) {
      document.body.style.paddingRight = `${getScrollBarSize()}px`;      
    }
    return (
      <div className={style.modalWrapper}>
        {
          modal.modals.map((item, i) => {
            return <div key={i} className={style.modal}>{item}</div>
          })
        }
      </div>
    )
  }

  renderNavPanel = (panel) => {
    if (!panel.visible) return null;
    return (
      <NavPanel
        removeMessage={this.props.removeMessage}
        {...panel}
      />
    )
  }

  render() {
    let { navPanel, modal } = this.props.layout;
    let wrapperClsName = modal.modals.length ? style.modalOpened : '';
    return (
      <div className={style.headerWrapper + ' ' + wrapperClsName}>
        <h3 className={style.header}><Link to="/">ONLINE SHOPPING</Link></h3>
        {this.renderNavPanel(navPanel)}
        {this.renderModals(modal)}
      </div>
    );
  }
}

const mapStateToProps = state => {
  return { layout: state.layout } 
}

export default connect(mapStateToProps, null)(Header);