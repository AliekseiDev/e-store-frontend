import React, { Component } from 'react';

import Image from '$components/Image';
import { Link } from 'react-router-dom';
import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';
import ConfirmModal from '$components/Modal/ConfirmModal';

import style from './Basket.module.css';

class Cart extends Component {

  checkout = () => {
    alert(JSON.stringify(this.props.items));
  }

  renderGeneralInfo = () => {
    let { totalCount, totalSum } = this.props;
    return (
      <div className={style.generalInfo}>
        <p><strong>Total sum:</strong> ${totalSum}</p>
        <p><strong>Items in your shopping cart:</strong> {totalCount}</p>
      </div>
    );
  }

  renderItemsList = () => {
    let { items } = this.props;
    return items.map((_item, i) => {
      let {item} = _item;
      return (
        <div key={item.id} className={style.cartItemWrapper}>
          <div>
            <Image className={style.cartItemImage} src={item.image}/>
            <div className={style.cartItemInfo}><Link to={`/phones/${item.id}`}>{item.name}</Link></div>
            <div className={style.cartItemInfo}><strong>Price:</strong> ${item.price}</div>
            <div className={style.cartItemInfo}><strong>Amount:</strong> {_item.amount}</div>
          </div>
          <div 
            className={style.removeBtn}
            onClick={() => {
              this.props.openModal(
                <ConfirmModal
                  text={`Do you want to remove ${item.name} from your cart?`}
                  onConfirm={() => this.props.removeProductFromBasket(item.id)}
                />
              );
            }}  
          >
            Delete from cart <FontAwesomeIcon icon="trash"/>
          </div>            
        </div>
      );
    })
  }

  renderBasketControls = () => {
    return (
      <div style={{margin: '10px', width: '100%'}}>
            
        <div 
          className={`${style.btn} ${style.checkout}`}
          onClick={this.checkout}
        >
          Checkout
        </div>
        <Link to="/" className={`${style.btn}`}>Back to store</Link>
        <div 
          className={`${style.btn} ${style.clearCart}`}
          onClick={() => {
            this.props.openModal(
              <ConfirmModal
                text="Do you want to remove all the products from your cart?"
                onConfirm={this.props.cleanBasket}
              />
            )
           }}
        >
            Clear cart
            <FontAwesomeIcon style={{marginLeft: '7px'}} icon="trash"/>
          </div>
      </div>
    );
  }

  render() {
    return (
      <div className={style.wrapper}>
        {this.renderGeneralInfo()}
        <div className={style.basketContent}>
          <div className={style.controls}>
            {this.renderBasketControls()}
          </div>
          <div className={style.table}>
            {this.renderItemsList()}
          </div>
        </div>
      </div>
    );
  }
}

export default Cart;