import React, { Component } from 'react';

import { Link } from 'react-router-dom';
import Image from '$components/Image';
import Loading from '$components/Loading'; 
import { FontAwesomeIcon } from '@fortawesome/react-fontawesome'

import style from './PhoneCard.module.css';

class PhoneCard extends Component {

  renderPhoneImage = (item) => (
    <Image
      onLoad={() => {
        if (!item.imageLoaded) this.props.onImageLoaded(item);
      }}
      src={item.image}
      alt={item.name}
    > 
      <div className={style.imageInner}>
        {
          item.imageLoaded ? 
            null
          :
            <div className={style.loader}><Loading/></div>
        }
      </div>
    </Image>
  )

  renderPhone = (item) => {
    let { description, name, price, id } = item;
    let shortDescr = `${description.slice(0, 60)}...`;
    let inBasketCls = item.inBasket ? ` ${style.inBasket}` : ''
    return (
      <div className={style.card}>
        {this.renderPhoneImage(item)}
        <div className={style.info}>
          <h4 className={style.cardTitle}>
            <Link to={`/phones/${id}`}>
              {name}
            </Link>
          </h4>
          <h4>${price}</h4>
          <p>{shortDescr}</p>
        </div>
        <div className={style.controls}>
          <div 
            className={`${style.buyNow} ${inBasketCls}`}
            onClick={() => this.props.toCart(item)}
          >
            <FontAwesomeIcon icon="shopping-cart"/>
          </div>
          <Link 
            className={style.moreInfo} 
            to={`/phones/${id}`}
          >
            More info
          </Link>
        </div>
      </div>
    );
  }

  render() {
    return this.renderPhone(this.props.data);
  }
}

export default PhoneCard;