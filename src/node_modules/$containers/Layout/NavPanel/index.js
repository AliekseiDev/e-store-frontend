import React, { Component } from 'react';

import Loading from '$components/Loading';

import Cart from './items/Cart';
import Icon from './items/Icon';

import style from './NavPanel.module.css';

class NavPanel extends Component {

  renderItems = (items) => {
    if (!items.length) return null;

    return items[items.length - 1].map((item, i) => {
      let key = i + item.type;
      switch (item.type) {
        case 'cart':
          return <Cart key={key}/> 
        
        case 'close':
          return <Icon key={key} icon="times" onClick={item.onClick}/>

        case 'filter':
          return <Icon key={key} icon="filter" onClick={item.onClick}/>

        case 'empty':
          return <div key={key}/>
        
        case 'text':
          return <div className={style.panelItemText} key={key}>{item.text}</div>
        
        default:
          return null;
      }
    });
  }

  renderMessage = (messages) => {
    let message = messages[messages.length - 1];
    
    return (
      <div key={message.id} className={style.message}>{message.text}</div>
    );
  }

  render() {
    let {items, loading, messages} = this.props;
    return (
      <div className={style.panel}>
        {
          loading ?
            <div className={style.loading}><Loading/></div> 
          :
            messages.length ? 
              this.renderMessage(messages)
            :
              this.renderItems(items)
        }
      </div>
    );
  }
}

export default NavPanel;