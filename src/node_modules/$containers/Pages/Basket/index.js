import React, { Component } from 'react';
import { connect } from 'react-redux';

import Cart from './Cart';
import EmptyCart from './EmptyCart';

import { getTotalBasketCount, getTotalBasketSum, getBasketProducts } from '$selectors';
import { addProductToBasket, removeProductFromBasket, cleanBasket } from '$actions/basketActions';
import { setNavPanelItemsState, openModal, pushNavPanelItemsState, popNavPanelItemsState, pushMessage } from '$actions/layoutActions';

class Basket extends Component {

  componentDidMount = () => {

    window.scrollTo(0, 0);

    let navPanelItems = [
      { type: 'empty' },
      { type: 'text', text: 'My cart' },
      { type: 'empty' }
    ];
    this.props.setNavPanelItemsState(navPanelItems);
    
  }

  render() {
    let { totalCount } = this.props;
    return (
      totalCount ?
        <Cart {...this.props}/>
      :
        <EmptyCart/>
    );
  }
}

const mapStateToProps = state => {
  return {
    totalCount: getTotalBasketCount(state),
    totalSum: getTotalBasketSum(state),
    items: getBasketProducts(state)
  }
}

const mapDispatchToProps = {
  setNavPanelItemsState, pushNavPanelItemsState, popNavPanelItemsState,
  openModal,
  pushMessage,
  addProductToBasket, removeProductFromBasket, cleanBasket
};

export default connect(mapStateToProps, mapDispatchToProps)(Basket);